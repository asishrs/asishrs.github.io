<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Spring Cloud Config Auto Refresh + Custom Kafka topic - Asish Soudhamma</title><meta name=Description content="This is my cool site"><meta property="og:title" content="Spring Cloud Config Auto Refresh + Custom Kafka topic"><meta property="og:description" content="Spring Cloud Config is one of the best features that Spring provides as part of the framework. Spring Cloud Config allows your java application to follow Externalized configuration pattern which is must have if you are building microservices. Additionally, you can also enable the automatic config refresh in Spring Cloud Config so that all your components receive the latest configuration values when there is a change in the configuration. For automatic configuration delivery, Spring Cloud use Kafka or RabbitMQ messaging platforms."><meta property="og:type" content="article"><meta property="og:url" content="https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-10-17T23:13:15-07:00"><meta property="article:modified_time" content="2018-10-17T23:13:15-07:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring Cloud Config Auto Refresh + Custom Kafka topic"><meta name=twitter:description content="Spring Cloud Config is one of the best features that Spring provides as part of the framework. Spring Cloud Config allows your java application to follow Externalized configuration pattern which is must have if you are building microservices. Additionally, you can also enable the automatic config refresh in Spring Cloud Config so that all your components receive the latest configuration values when there is a change in the configuration. For automatic configuration delivery, Spring Cloud use Kafka or RabbitMQ messaging platforms."><meta name=application-name content="Asish Soudhamma"><meta name=apple-mobile-web-app-title content="Asish Soudhamma"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/><link rel=prev href=https://asishrs.com/2018/10/docker-limit-cgroup/><link rel=next href=https://asishrs.com/2020/02/aws-lambda-cloudformation/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Spring Cloud Config Auto Refresh + Custom Kafka topic","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/asishrs.com\/2018\/10\/spring-cloud-config-refresh-kafka\/"},"genre":"posts","keywords":"spring, kafka, cloud","wordcount":367,"url":"https:\/\/asishrs.com\/2018\/10\/spring-cloud-config-refresh-kafka\/","datePublished":"2018-10-17T23:13:15-07:00","dateModified":"2018-10-17T23:13:15-07:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Asish Soudhamma"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Asish Soudhamma"><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts>Posts </a><a class=menu-item href=/tags>Tags </a><a class=menu-item href=/categories>Categories </a><a class=menu-item href=/about>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Asish Soudhamma"><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts title>Posts</a><a class=menu-item href=/tags title>Tags</a><a class=menu-item href=/categories title>Categories</a><a class=menu-item href=/about title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Spring Cloud Config Auto Refresh + Custom Kafka topic</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Asish Soudhamma</a></span>&nbsp;<span class=post-category>included in <a href=/categories/documentation/><i class="far fa-folder fa-fw" aria-hidden=true></i>Documentation</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2018-10-17>2018-10-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;367 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;2 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#what-if-you-have-to-mention-your-own-kafka-topics>What if you have to mention your own Kafka topics?</a></li><li><a href=#bonus--how-can-you-use-this-with-mutual-authentication>Bonus — How can you use this with mutual authentication?</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></div><div class=content id=content><img class="cp t u fz ak" src=/images/posts/spring-kafka/spring-kafka.png role=presentation><p><a href=https://cloud.spring.io/spring-cloud-config/ target=_blank rel="noopener noreffer">Spring Cloud Config</a> is one of the best features that Spring provides as part of the framework. Spring Cloud Config allows your java application to follow Externalized configuration pattern which is must have if you are building microservices. Additionally, you can also enable the automatic config refresh in Spring Cloud Config so that all your components receive the latest configuration values when there is a change in the configuration. For automatic configuration delivery, Spring Cloud use Kafka or RabbitMQ messaging platforms. This article is going to explain how to define your own Kafka topics with Spring Cloud Config.</p><p>Using default configuration, Spring Cloud Config use predefined Kafka channel springCloudBusInput and springCloudBusOutput. Also, Kafka configuration expects you to provide the <em>zookeeper</em> nodes using the option <em>spring.cloud.stream.kafka.binder.zkNodes</em>. This works well if you are using a Kafka broker that you manage or you have control. In that instance, your configuration looks like below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>spring:
</span></span><span class=line><span class=cl> cloud:
</span></span><span class=line><span class=cl>  stream:
</span></span><span class=line><span class=cl>   kafka:
</span></span><span class=line><span class=cl>    binder:
</span></span><span class=line><span class=cl>     zkNodes: &#34;&lt;zookeeper-host&gt;:&lt;zookeeper-port&gt;&#34;
</span></span><span class=line><span class=cl>     brokers: &#34;&lt;broker-host&gt;:&lt;broker-port&gt;&#34;
</span></span></code></pre></td></tr></table></div></div><h2 id=what-if-you-have-to-mention-your-own-kafka-topics>What if you have to mention your own Kafka topics?</h2><p>Above configuration won’t work if you are using a shared Kafka infrastructure which you cannot control, or you cannot create a topic dynamically on the Kafka. Luckily spring provides configuration options for you to pass custom Kafka topics and disable the auto topic creation.</p><p>Below are the options you can use for supply your topic names.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>spring.cloud.stream.bindings.springCloudBusInput=&lt;your\_custom\_input\_topic\_name&gt;
</span></span><span class=line><span class=cl>spring.cloud.stream.bindings.springCloudBusOutput=&lt;your\_custom\_output\_topic\_name&gt;
</span></span></code></pre></td></tr></table></div></div><p>You can disable the automatic topic creation using below option.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>spring.cloud.stream.kafka.binder.autoCreateTopics=false
</span></span></code></pre></td></tr></table></div></div><p>Complete configuration looks like below</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>spring.cloud.stream:
</span></span><span class=line><span class=cl> bindings:
</span></span><span class=line><span class=cl>  springCloudBusInput:
</span></span><span class=line><span class=cl>   destination: &lt;your\_custom\_kafka\_input\_topic&gt;
</span></span><span class=line><span class=cl>   group: &lt;optional group id&gt;springCloudBusOutput:
</span></span><span class=line><span class=cl>   destination: &lt;your\_custom\_kafka\_output\_topic&gt;
</span></span><span class=line><span class=cl> kafka.binder:
</span></span><span class=line><span class=cl>   autoCreateTopics: false
</span></span><span class=line><span class=cl>   brokers: &lt;your\_kafka\_broker\_host&gt;:&lt;your\_kafka\_broker\_port&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=bonus--how-can-you-use-this-with-mutual-authentication>Bonus — How can you use this with mutual authentication?</h2><p>Spring Cloud Stream supports configuration options for mutual authentication via SSL. Here is a sample configuration.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>spring.cloud.stream:
</span></span><span class=line><span class=cl> kafka.binder:
</span></span><span class=line><span class=cl>   autoCreateTopics: false
</span></span><span class=line><span class=cl>   brokers: &lt;your\_kafka\_broker\_host&gt;:&lt;your\_kafka\_broker\_port&gt;
</span></span><span class=line><span class=cl>   configuration:
</span></span><span class=line><span class=cl>     “\[security.protocol\]“: SSL
</span></span><span class=line><span class=cl>     “\[ssl.enabled\]“: true
</span></span><span class=line><span class=cl>     “\[ssl.truststore.location\]“: &lt;path/truststore\_file&gt;
</span></span><span class=line><span class=cl>     “\[ssl.truststore.password\]“: &lt;your\_truststore\_password&gt;
</span></span><span class=line><span class=cl>     “\[ssl.keystore.location\]“: &lt;path/keystore\_file&gt;
</span></span><span class=line><span class=cl>     “\[ssl.keystore.password\]“: &lt;your\_keystore\_password&gt;
</span></span><span class=line><span class=cl>     “\[ssl.key.password\]“: &lt;your\_key\_password&gt;
</span></span><span class=line><span class=cl>     “\[sasl.mechanism\]“: PLAIN
</span></span><span class=line><span class=cl>     “\[ssl.protocol\]“: TLSv1.2 // Check this with the Cert
</span></span><span class=line><span class=cl>     “\[ssl.enabled.protocols\]“: TLSv1.2 // Check this with the Cert
</span></span><span class=line><span class=cl>     “\[ssl.endpoint.identification.algorithm\]“: HTTPS
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=reference>Reference</h2><ul><li><a href=https://cloud.spring.io/spring-cloud-config/ target=_blank rel="noopener noreffer">Spring Cloud Config</a></li><li><a href=https://spring.io/projects/spring-cloud target=_blank rel="noopener noreffer">Spring Cloud</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2018-10-17</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/ data-title="Spring Cloud Config Auto Refresh + Custom Kafka topic" data-via=asishrs data-hashtags=spring,kafka,cloud><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/ data-title="Spring Cloud Config Auto Refresh + Custom Kafka topic"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Pocket" data-sharer=pocket data-url=https://asishrs.com/2018/10/spring-cloud-config-refresh-kafka/><i class="fab fa-get-pocket fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/spring/>spring</a>,&nbsp;<a href=/tags/kafka/>kafka</a>,&nbsp;<a href=/tags/cloud/>cloud</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2018/10/docker-limit-cgroup/ class=prev rel=prev title="Docker limit resource utilization using cgroup-parent"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Docker limit resource utilization using cgroup-parent</a>
<a href=/2020/02/aws-lambda-cloudformation/ class=next rel=next title="Automated and Authenticated APIs stack using Lambda, API Gateway and Cloudformation (AWS)">Automated and Authenticated APIs stack using Lambda, API Gateway and Cloudformation (AWS)<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2018 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Asish Soudhamma</a></span>&nbsp;|&nbsp;<span class=license>MIT</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"⌂","id-2":"⌂"},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>